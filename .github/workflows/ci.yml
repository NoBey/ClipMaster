name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: macos-latest

    steps:
      # 1. 检出代码
      - name: Checkout
        uses: actions/checkout@v4

      # 2. 构建应用（使用系统自带的 Swift）
      - name: Build App
        run: |
          chmod +x build_app.sh
          ./build_app.sh

      # 3. 验证构建产物
      - name: Verify Build
        run: |
          if [ ! -d "build/ClipMaster.app" ]; then
            echo "Build failed: .app not found"
            exit 1
          fi
          echo "✅ Build verified"
